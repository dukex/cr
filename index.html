<!DOCTYPE html>
<html>
  <head>
    <title>Hello World!</title>
    <link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="assets/app.css" media="screen" title="no title" charset="utf-8">
    <link rel="stylesheet" href="./node_modules/highlight.js/styles/monokai_sublime.css" media="screen" title="no title" charset="utf-8">
  </head>
  <body>
    <div id="app">
    </div>

    <script id="commits-template" type="text/ractive">
      <button on-click="all_reviewed">Mark all as reviewed</button>
      <label>
      <input type="checkbox" checked='{{showReviewed}}'> Show Reviewed
      </label>
      <ul id="commits">
        {{#each filter(commits, showReviewed) :index}}
          <li id="commit-{{sha}}" data-i='{{index}}' class='{{ reviewed ? "reviewed" : "" }}'>
            <b>{{sha_short}}</b>
            <span class="author">{{author}}</span>
            -
            {{message_shot}}
            <span class="date">{{date}}</span>
            <button on-click="reviewed" data-id="{{sha}}">Mark as reviewed</button>
            <button on-click="delay">Delay review</button>
            <button on-click="review">Review</button>
          </li>
        {{/each}}
      </ul>
    </script>

    <script id="commit-template" type="text/x-handlebars-template">
      <button on-click="back">Voltar</button>
      <h1>
        <b>{{commit.sha_short}}</b>
        <span class="author">{{commit.author}}</span>
        -
        {{commit.message}}
        <span class="date">{{commit.date}}</span>

        <button>Mark as reviewed</button>
      </h1>

      <ul>
      {{#commit.files}}
        <li><a href="#file-{{name}}">{{name}}</a></li>
      {{/each}}
      </ul>

      <ul>
      {{#commit.files}}
        <li id="file-{{name}}">
          <h3>{{name}}</h3>
          {{diffText}}
        </li>
      {{/each}}
    </script>

    <script type="text/javascript">
      window.RSVP = require('./assets/vendor/rsvp.js');
      window.RouteRecognizer = require('./assets/vendor/route-recognizer.js');
    </script>

    <script src="assets/vendor/ractive.js" charset="utf-8"></script>
    <script src="assets/vendor/router.js" charset="utf-8"></script>
    <script src="assets/string.js" charset="utf-8"></script>
    <script src="assets/diff.js" charset="utf-8"></script>
    <script src="assets/controllers.js" charset="utf-8"></script>
    <script src="assets/router.js" charset="utf-8"></script>
    <script src="assets/app.js" charset="utf-8"></script>

    <script type="text/javascript">
      var moment = require('moment');

      var ipc = require('ipc');
      ipc.on('open', function(data) {
        var directory = data[0];
        startApp(directory);
      });
      // var showHistory = function(d) {
      //   history.on('commit', function(commit) {
      //     reviewedEl.addEventListener('click', function (e) {
      //       reviewed.child(this.sha().slice(0, 6)).set({
      //         reviewed: true
      //       });
      //       e.preventDefault();
      //     }.bind(commit), false);
      //   });
      //
      //   history.start();
      //   reviewed.on("value", function (snapshot) {
      //     if(!snapshot.val()){
      //       return
      //     }
      //     var data = snapshot.val();
      //     Object.keys(data).forEach(function(sha){
      //       var commit = document.querySelector("#commit-" + sha);
      //       if(data[sha].reviewed) {
      //         commit && commit.classList.add('reviewed');
      //       }
      //     })
      //   })
      // };
      </script>
  </body>
</html>
